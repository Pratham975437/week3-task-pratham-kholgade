import json
import base64
import os

# The file where credentials will be store
DATA_FILE = 'passwords.json'

def encode_password(password):
    """Encodes a password using Base64."""
    return base64.b64encode(password.encode('utf-8')).decode('utf-8')

def decode_password(encoded_password):
    """Decodes a Base64-encoded password."""
    return base64.b64decode(encoded_password.encode('utf-8')).decode('utf-8')

def load_data():
    """Loads existing data from the JSON file."""
    if os.path.exists(DATA_FILE):
        with open(DATA_FILE, 'r') as f:
            return json.load(f)
    return {}

def save_data(data):
    """Saves data to the JSON file."""
    with open(DATA_FILE, 'w') as f:
        json.dump(data, f, indent=4)

def add_entry():
    """Prompts the user for a new login and saves it."""
    website = input("Enter website: ")
    username = input("Enter username: ")
    password = input("Enter password: ")
    
    encoded_password = encode_password(password)
    
    data = load_data()
    data[website] = {
        'username': username,
        'password': encoded_password
    }
    
    save_data(data)
    print("Entry added successfully.")

def view_entries():
    """Views all stored entries."""
    data = load_data()
    if not data:
        print("No entries found.")
        return
        
    print("\n--- Stored Logins ---")
    for website, details in data.items():
        username = details['username']
        decoded_password = decode_password(details['password'])
        print(f"Website: {website}")
        print(f"Username: {username}")
        print(f"Password: {decoded_password}")
        print("-" * 20)

def main():
    """Main function to run the password manager."""
    while True:
        print("\nWhat would you like to do?")
        print("1. Add a new entry")
        print("2. View all entries")
        print("3. Exit")
        
        choice = input("Enter your choice (1, 2, or 3): ")
        
        if choice == '1':
            add_entry()
        elif choice == '2':
            view_entries()
        elif choice == '3':
            print("Exiting.")
            break
        else:
            print("Invalid choice. Please try again.")

if __name__ == "__main__":
    main()
