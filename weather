import requests
import json
import os

API_KEY = 52f38ac6093ab1d68d8c867cbd802e71 
BASE_URL = "https://api.openweathermap.org/data/2.5/weather"
HISTORY_FILE = "weather_history.json"

# Load previous history
def load_history():
    if os.path.exists(HISTORY_FILE):
        with open(HISTORY_FILE, "r") as file:
            return json.load(file)
    return []

# Save history
def save_history(history):
    with open(HISTORY_FILE, "w") as file:
        json.dump(history, file, indent=4)

# Fetch weather from API
def get_weather(city):
    params = {"q": city, "appid": API_KEY, "units": "metric"}
    response = requests.get(BASE_URL, params=params)
    data = response.json()
    if response.status_code == 200:
        weather_info = {
            "city": data["name"],
            "temp": data["main"]["temp"],
            "weather": data["weather"][0]["description"]
        }
        return weather_info
    else:
        print(" City not found!")
        return None

# Menu-based Dashboard
def main():
    history = load_history()

    while True:
        print("\nðŸŒ¦ Weather Dashboard")
        print("1. Search current weather")
        print("2. Show last 5 searches")
        print("3. Exit")

        choice = input("Enter choice: ")

        if choice == "1":
            city = input("Enter city name: ")
            weather = get_weather(city)
            if weather:
                print(f" {weather['city']} | {weather['temp']}Â°C | {weather['weather']}")
                history.append(weather)
                save_history(history)

        elif choice == "2":
            print("\n Last 5 Searches:")
            for w in history[-5:]:
                print(f"- {w['city']} | {w['temp']}Â°C | {w['weather']}")

        elif choice == "3":
            print("Exiting Weather Dashboard")
            break
        else:
            print(" Invalid choice, try again.")

if __name__ == "__main__":
    main()
